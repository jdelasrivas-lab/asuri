<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>predSurvCurve — predSurvCurve • asuri</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="predSurvCurve — predSurvCurve"><meta name="description" content="Function to predict the expected survival curve for a test patient given the risk score provided by a Cox regression model."><meta property="og:description" content="Function to predict the expected survival curve for a test patient given the risk score provided by a Cox regression model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">asuri</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/asuri.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jdelasrivas-lab/asuri/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>predSurvCurve</h1>

      <div class="d-none name"><code>predSurvCurve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to predict the expected survival curve for a test patient given the risk score provided by a Cox regression model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predSurvCurve</span><span class="op">(</span> <span class="va">cox_pred_training</span>, <span class="va">mSurv</span>, <span class="va">cox_pred_test</span>, eval_surv_times <span class="op">=</span> <span class="cn">NULL</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-cox-pred-training">cox_pred_training<a class="anchor" aria-label="anchor" href="#arg-cox-pred-training"></a></dt>
<dd><p>A numeric vector representing the predicted risk scores (or log-risk scores) from the Cox model for the training set. It can be obtained from *predict.patientRisk* function.</p></dd>

  <dt id="arg-msurv">mSurv<a class="anchor" aria-label="anchor" href="#arg-msurv"></a></dt>
<dd><p>A data frame with two columns: "time" representing survival times, and "status" representing the event status (1 for event, 0 for censored) for the training dataset.</p></dd>

    <dt id="arg-cox-pred-test">cox_pred_test<a class="anchor" aria-label="anchor" href="#arg-cox-pred-test"></a></dt>
<dd><p>A numeric vector of length 1 representing the predicted risk score (or log-risk score) for the test patient. It can be obtained from *predict.patientRisk* function.</p></dd>

   <dt id="arg-eval-surv-times">eval_surv_times<a class="anchor" aria-label="anchor" href="#arg-eval-surv-times"></a></dt>
<dd><p>A numeric vector of times at which the survival curve should be evaluated. If NULL (default), the times will be taken from the training data up to the maximum event time.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function will obtain the expected survival curve for a test patient given the risk score estimated by a multivariate Cox regression model. The Breslow estimator is considered to approximate the baseline Hazard. The cumulative baseline survival function is smoothed using the Friedman's super smoother. The function interpolates linearly the survival probability for time points not in the training set.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function provides a plot for the expected survival curve. It shows also the median survival time, that is, the time at which the survival probability drops to 0.5.
  The function also returns a list with the following objects:</p>
<dl><dt>eval_times</dt>
<dd><p>Vector of times in years at which the survival curve has been evaluated.</p></dd>

  <dt>S_0_t</dt>
<dd><p>Vector with the baseline survival probability estimated at each evaluation time.</p></dd>

  <dt>S_test_patient</dt>
<dd><p>Vector with the survival probability estimated at each evaluation time for a given test patient.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Martinez-Romero, J., Bueno-Fortes, S., Martín-Merino, M. <em>et al.</em> (2018) <b>Survival marker genes of colorectal cancer derived from consistent transcriptomic profiling</b>. <em>BMC Genomics</em> 19 (Suppl 8), 857 . <a href="https://doi.org/10.1186/s12864-018-5193-9" class="external-link">doi:10.1186/s12864-018-5193-9</a></p>
<p>Santiago Bueno-Fortes, Alberto Berral-Gonzalez, José Manuel Sánchez-Santos, Manuel Martin-Merino, Javier De Las Rivas (2023) <b>Identification of a gene expression signature associated with breast cancer survival and risk that improves clinical genomic platforms</b>, <em>Bioinformatics Advances</em>, Volume 3, Issue 1, vbad037, <a href="https://doi.org/10.1093/bioadv/vbad037" class="external-link">doi:10.1093/bioadv/vbad037</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the expression matrix with the subset of genes selected</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">matrixData</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data set ‘matrixData’ not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Train a multivariate risk predictor. If you have run already this function, please skip this step.</span></span></span>
<span class="r-in"><span><span class="va">multivariate_risk_predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="patientRisk.html">patientRisk</a></span><span class="op">(</span><span class="va">mExprSelectedGenes</span>, <span class="va">time</span>, <span class="va">status</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mExprSelectedGenes' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Expression matrix for a single test patient</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">mExprs_testData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="va">mExprSelectedGenes</span><span class="op">[</span>, <span class="va">i</span> <span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mExprSelectedGenes' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span> <span class="va">mExprs_testData</span> <span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mExprSelectedGenes</span><span class="op">)</span><span class="op">[</span> <span class="va">i</span> <span class="op">]</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'colnames': object 'mExprSelectedGenes' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cox prediction for training and test sets</span></span></span>
<span class="r-in"><span><span class="va">cox_pred_training</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="predict.patientRisk.html">predict.patientRisk</a></span><span class="op">(</span><span class="va">multivariate_risk_predictor</span>, <span class="va">mExprSelectedGenes</span> <span class="op">)</span><span class="op">$</span><span class="va">risk_score</span> <span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mExprSelectedGenes' not found</span>
<span class="r-in"><span><span class="va">cox_pred_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="predict.patientRisk.html">predict.patientRisk</a></span><span class="op">(</span><span class="va">multivariate_risk_predictor</span>, <span class="va">mExprs_testData</span> <span class="op">)</span><span class="op">$</span><span class="va">risk_score</span> <span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mExprs_testData' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Survival curve estimation</span></span></span>
<span class="r-in"><span><span class="va">eval_surv_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mPheno</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, by<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mPheno' not found</span>
<span class="r-in"><span><span class="va">surv_curv_cox</span> <span class="op">&lt;-</span> <span class="fu">predSurvCurve</span><span class="op">(</span> <span class="va">cox_pred_training</span>, <span class="va">mPheno</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="va">cox_pred_test</span>, <span class="va">eval_surv_times</span> <span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mPheno' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alberto Berral-Gonzalez, Santiago Bueno-Fortes, Natalia Alonso-Moreda, Jose Manuel Sanchez-Santos, Manuel Martin-Merino Acera, Javier De Las Rivas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

