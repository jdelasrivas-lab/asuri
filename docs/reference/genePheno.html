<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>genePheno — genePheno • asuri</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="genePheno — genePheno"><meta name="description" content="This function implements robust algorithms to obtain a list of genes associated to a given clinical variable. It is based on the elastic net algorithm and the robustness and reproducibility of the subset of genes is improved using a bootstrap strategy combined with ensemble methods."><meta property="og:description" content="This function implements robust algorithms to obtain a list of genes associated to a given clinical variable. It is based on the elastic net algorithm and the robustness and reproducibility of the subset of genes is improved using a bootstrap strategy combined with ensemble methods."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">asuri</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/asuri.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jdelasrivas-lab/asuri/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>genePheno</h1>

      <div class="d-none name"><code>genePheno.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements robust algorithms to obtain a list of genes associated to a given clinical variable. It is based on the elastic net algorithm and the robustness and reproducibility of the subset of genes is improved using a bootstrap strategy combined with ensemble methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">genePheno</span><span class="op">(</span><span class="va">mExpr</span>, <span class="va">vectorGroups</span>, <span class="va">vectorSampleID</span>, iter <span class="op">=</span> <span class="fl">100</span>, numberOfFolds <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-mexpr">mExpr<a class="anchor" aria-label="anchor" href="#arg-mexpr"></a></dt>
<dd><p>A matrix with normalized gene expression data. Rows correspond to samples, and columns correspond to genes. `rownames(mExpr)` should be set to sample names, and `colnames(mExpr)` should be set to gene names.</p></dd>

  <dt id="arg-vectorgroups">vectorGroups<a class="anchor" aria-label="anchor" href="#arg-vectorgroups"></a></dt>
<dd><p>Clinical variable. It must be provided as a numeric binary vector.</p></dd>

  <dt id="arg-vectorsampleid">vectorSampleID<a class="anchor" aria-label="anchor" href="#arg-vectorsampleid"></a></dt>
<dd><p>Vector containing the sample names ordered as in the expression matrix.</p></dd>

  <dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Number of bootstrap iterations (default: 100, should be changed if the function takes too long to execute).</p></dd>

  <dt id="arg-numberoffolds">numberOfFolds<a class="anchor" aria-label="anchor" href="#arg-numberoffolds"></a></dt>
<dd><p>Number of folds to implement nested cross-validation. By default 10.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements a robust version of the elastic net algorithm proposed by Tibshirani (Tibshirani et al., 2009).
This algorithm considers a penalty term to avoid overfitting that is a convex combination of the L<sub>2</sub> norm (ridge regression) and L<sub>1</sub> (Lasso regression). When the alpha parameter is 1, the regularization term perfoms similarly to Lasso and minimizes the number of non-null coefficients. If a subset of features are slightly correlated Lasso selects only one of them randomly. To avoid this extreme behavior the alpha parameter is set up to 0.75 that includes more relevant variables than Lasso and improves the prediction accuracy. Besides, this choice will help to improve the stability and to reduce the variance in the feature selection process.
In order to improve the robustness and reproducibility of the gene signature discovered, a bootstrap strategy is implemented. The patients are resampled with replacement giving rise to B replicates.
  For each replicate a gene signature is obtained using double nested cross-validation to avoid overfitting. The final gene list is built as an ensemble of lists, considereing several metrics that evaluate the stability, the robustness and the predictive power of each gene. See (Martinez-Romero et al., 2018) for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list is provided with the following objects:</p>
<dl><dt>genes</dt>
<dd><p>A list of genes ranked according to the degree of association with the clinical or phenotypic variable tested.</p></dd>

  <dt>listCoeff</dt>
<dd><p>A list with the beta regression coefficients and the AUC score for each bootstrap iteration.</p></dd>

  <dt>stability</dt>
<dd><p>Gene selection probability estimated by bootstrap (the number of times discovered over "n" iterations).</p></dd>

  <dt>betasMedian</dt>
<dd><p>Median of the beta coefficients over the B replicates.</p></dd>

  <dt>betasMean</dt>
<dd><p>Mean of the beta coefficients over the B replicates.</p></dd>

  <dt>betasTable</dt>
<dd><p>Table of genes ordered by decreasing value of the stability coefficient. Contains several metrics: the stability index, the mean and the median of the beta coefficients.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Martinez-Romero, J., Bueno-Fortes, S., Martín-Merino, M. <em>et al.</em> (2018) <b>Survival marker genes of colorectal cancer derived from consistent transcriptomic profiling</b>. <em>BMC Genomics</em> 19 (Suppl 8), 857 . <a href="https://doi.org/10.1186/s12864-018-5193-9" class="external-link">doi:10.1186/s12864-018-5193-9</a></p>
<p>Santiago Bueno-Fortes, Alberto Berral-Gonzalez, José Manuel Sánchez-Santos, Manuel Martin-Merino, Javier De Las Rivas (2023) <b>Identification of a gene expression signature associated with breast cancer survival and risk that improves clinical genomic platforms</b>, <em>Bioinformatics Advances</em>, Volume 3, Issue 1, vbad037, <a href="https://doi.org/10.1093/bioadv/vbad037" class="external-link">doi:10.1093/bioadv/vbad037</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">genePheno</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Gene expression matrix filtered by SAM differential expression function</span></span></span>
<span class="r-in"><span>  <span class="va">mExprsDE</span> <span class="op">&lt;-</span> <span class="va">mExprs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">DE_list_genes</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mExprs</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mExprsDE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 865 200</span>
<span class="r-in"><span>  <span class="co"># [1] 865  200</span></span></span>
<span class="r-in"><span>  <span class="va">tmExprsDE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mExprsDE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Parameters: Number of bootstrap iterations: 100.</span></span></span>
<span class="r-in"><span>  <span class="co"># The object `tmExprsDE` is the gene expression matrix for the subset of genes tested (samples as rows and genes as columns). The object `mPheno$ER.IHC` is a vector indicating the value per-sample of ER (as a binary variable: "0" or "1").</span></span></span>
<span class="r-in"><span>  <span class="va">vectorSampleID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mPheno</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">vectorGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mPheno</span><span class="op">$</span><span class="va">ER.IHC</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Pred_ER.IHC</span> <span class="op">&lt;-</span> <span class="fu">genePheno</span><span class="op">(</span><span class="va">tmExprsDE</span>, <span class="va">vectorGroups</span>, <span class="va">vectorSampleID</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-24 14:01:37.249795</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 10 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 20 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 30 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 40 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 50 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 60 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 70 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 80 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 90 %</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Progress: 100 %</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Pred_ER.IHC is an output object with the list of genes that show a significant correlation with the clinical variable. Since a bootstrap is performed, the results of how many times across iterations a gene is found significant are reported as *stability* (in relative numbers 0-1, 1=100%) and the *beta values* from the regression across iterations are also provided as *betaMedian* and *betaMean* :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Pred_ER.IHC</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "genes"       "listCoeff"   "stability"   "betasMedian" "betasMean"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "betasTable" </span>
<span class="r-in"><span>  <span class="co"># [1] "genes" "listCoeff" "stability" "betasMedian" "betasMean" "betasTable"</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alberto Berral-Gonzalez, Santiago Bueno-Fortes, Natalia Alonso-Moreda, Jose Manuel Sanchez-Santos, Manuel Martin-Merino Acera, Javier De Las Rivas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

